<template>
  <style>
    m-name, m-channels {
      display: block;
    }
    m-name {
      color: black;
      font-size: 200%;
    }
    m-channels {
      width: 100%;
      height: 100%;
      overflow-x: scroll;
      overflow-y: hidden;
    }
    m-channels x-channel {
      width: 300px;
      display: block;
      float: left;
    }
  </style>

  <m-name></m-name>
  <m-channels></m-channels>
</template>

<script type="text/javascript">
  (function () {
    "use strict";

    var template = document.currentScript.ownerDocument.querySelector('template');

    class Board extends HTMLElement {
      createdCallback() {
        this.createShadowRoot().appendChild(document.importNode(template.content, true));
        this.config = null;
        this.data = null;
        this.nameElem = this.shadowRoot.querySelector('m-name');
        this.channelsElem = this.shadowRoot.querySelector('m-channels');
      }

      setName(name) {
        this.nameElem.textContent = name;
        return this;
      }

      setData(config, data) {
        this.config = config;
        this.data = data;

        // set name
        this.setName(this.config.name);

        // Remove all children
        while (this.channelsElem.firstChild) {
          this.channelsElem.removeChild(this.channelsElem.firstChild);
        }

        // update new data
        this.config.channels.forEach(function (channelConfig, index) {
          this.channelsElem.appendChild(
            document.createElement('x-channel')
            .setData(channelConfig, this.data[index]));
        }, this);

        return this;
      }
    }

    document.registerElement("x-board", Board);
  })();
</script>
